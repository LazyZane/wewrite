# WeWrite - Obsidian主题自动转换功能 PRD

## 项目背景

用户希望能够将当前使用的Obsidian主题自动转换为WeWrite主题，实现视觉风格的一致性，避免手动创建主题的复杂过程。

## 用户故事

**作为** WeWrite用户  
**我希望** 能够一键将我当前的Obsidian主题转换为WeWrite主题  
**这样** 我就可以在WeWrite中保持与Obsidian相同的视觉体验，提高工作效率

## 核心功能需求

### 1. 主题自动检测与提取
- **功能描述**: 自动检测当前激活的Obsidian主题名称和颜色方案
- **用户价值**: 无需手动输入主题信息，系统自动识别
- **验收标准**: 
  - 能够准确识别主题名称（如"Underwater"）
  - 能够区分浅色/深色主题模式
  - 支持自定义主题和官方主题

### 2. 颜色值精确提取
- **功能描述**: 从Obsidian的CSS中提取实际使用的颜色值
- **用户价值**: 确保生成的主题与Obsidian视觉效果完全一致
- **验收标准**:
  - 提取主要颜色：背景色、文字色、强调色、边框色等
  - 支持深色主题的颜色提取（如Underwater主题的深蓝色背景）
  - 处理CSS变量的层级继承关系

### 3. WeWrite主题文件生成
- **功能描述**: 将提取的颜色值转换为符合WeWrite规范的主题文件
- **用户价值**: 生成的主题可以直接在WeWrite中使用
- **验收标准**:
  - 生成标准的Markdown格式主题文件
  - 包含完整的CSS变量定义
  - 支持文章预览的实时样式应用

### 4. 一键生成操作
- **功能描述**: 通过简单的按钮点击完成整个转换过程
- **用户价值**: 操作简单，无需技术背景
- **验收标准**:
  - 界面中有明确的"生成Obsidian主题"按钮
  - 生成过程有进度提示
  - 生成完成后有成功反馈

## 非功能性需求

### 性能要求
- 主题生成时间 < 3秒
- 不影响Obsidian的正常使用性能

### 兼容性要求
- 支持Obsidian官方主题
- 支持社区自定义主题
- 兼容浅色和深色主题模式

### 可靠性要求
- 颜色提取准确率 > 95%
- 生成的主题文件格式正确率 100%

## 优先级排序

### P0 (必须有)
1. 颜色值精确提取 - 核心功能
2. WeWrite主题文件生成 - 基础输出

### P1 (应该有)  
3. 主题自动检测 - 用户体验
4. 一键生成操作 - 易用性

### P2 (可以有)
- 主题预览功能
- 批量主题转换
- 主题版本管理

## 当前问题分析

### 已识别的技术难点
1. **CSS变量提取不准确**: `getComputedStyle()` 无法获取正确的主题颜色值
2. **主题检测机制缺失**: 无法准确识别当前激活的主题名称
3. **深色主题支持不足**: 特别是Underwater等深色主题的颜色提取失败

### 风险评估
- **高风险**: 颜色提取准确性直接影响用户体验
- **中风险**: 不同主题的兼容性问题
- **低风险**: 界面交互的易用性问题

## 成功指标

### 定量指标
- 主题转换成功率 > 90%
- 用户满意度 > 4.5/5
- 功能使用率 > 60%

### 定性指标
- 生成的主题视觉效果与Obsidian高度一致
- 用户反馈操作简单易用
- 减少手动创建主题的时间成本

## 下一步行动

1. 深入分析Obsidian的主题系统架构
2. 研究更可靠的颜色提取方法
3. 设计新的技术实现方案
4. 制定详细的开发计划

---
*文档创建时间: 2025-07-13*  
*版本: v1.0*  
*状态: 待技术方案确认*
